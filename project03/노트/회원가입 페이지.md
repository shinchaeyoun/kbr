main.jsx 구조
```
import React, { StrictMode } from "react";
import { BrowserRouter, Routes, Route } from "react-router-dom";

import { createRoot } from "react-dom/client";
import "./index.css";
import GlobalStyle from "./styled/GlobalStyle.jsx";
import App from "./App.jsx";
import PrivateEnterRoute from "./components/PrivateEnterRoute.jsx";
import Header from "./components/Header.jsx";
import Footer from "./components/Footer.jsx";

createRoot(document.getElementById("root")).render(
  <React.StrictMode>
    <BrowserRouter>
      <GlobalStyle />
      {/* <App /> */}
      <PrivateEnterRoute />
      {/* <Footer /> */}
    </BrowserRouter>
  </React.StrictMode>
);
```

<br/>
<br/>

PrivateEnterRoute 페이지 구조
```
import React, { useState, useEffect } from "react";
import App from "../App.jsx";
import Login from "../pages/Login.jsx";
import Signup from "../pages/Signup.jsx";
import ApprovalPendingScreen from "./ApprovalPendingScreen.jsx";

const PrivateEnterRoute = () => {
  const level = Number(sessionStorage.user_lvl) || 0;
  const [showSignup, setShowSignup] = useState(false);

  console.log("level", level);

  // 1. level이 1이면 승인 대기 화면 표시
  if (level === 1) {
    return <ApprovalPendingScreen />;
  }

  // 2. level이 1보다 작거나 0일 경우 Login 또는 Signup으로만 이동 가능
  if (level < 1) {
    return showSignup ? (
      <Signup />
    ) : (
      <Login onSignupClick={() => setShowSignup(true)} />
    );
  }

  // return level >= 2 ? <App level={level} /> : <Login />;
  
  // 3. level이 2 이상일 경우 App으로 이동
  return <App level={level} />;
};

export default PrivateEnterRoute;
```


<br/><br/>
이 상태에서 로그인














=================

리액트로 **권한이 있는 회원만 볼 수 있는 홈페이지**를 효율적으로 만들기 위해서는 **권한 관리**를 중심으로 컴포넌트를 설계해야 합니다. 아래는 효율적인 구성 방법과 컴포넌트 설계 가이드입니다:

---

### 1. **컴포넌트 계층 구조 설계**
먼저 컴포넌트 계층 구조를 설계하여, 각 컴포넌트가 역할에 따라 동작하도록 만듭니다.

#### 기본 구조:
1. **`App` 컴포넌트**: 전체 애플리케이션의 컨테이너.
2. **`AuthProvider` 컴포넌트**: 사용자의 권한 정보를 관리하는 컨텍스트 제공자.
3. **`ProtectedRoute` 컴포넌트**: 권한이 있는 사용자만 접근할 수 있는 경로를 처리.
4. **페이지 컴포넌트**: `Home`, `Dashboard`, `Login` 등 각 페이지 역할.
5. **기타 공통 컴포넌트**: 네비게이션 바, 헤더, 푸터 등.

---

### 2. **권한 관리 로직**
React의 **Context API** 또는 **React Redux**를 사용해 전역 상태로 사용자 권한 정보를 관리합니다.

#### 예시: `AuthProvider` 컴포넌트
```javascript
import React, { createContext, useState, useContext } from "react";

const AuthContext = createContext();

export const AuthProvider = ({ children }) => {
  const [isAuthenticated, setIsAuthenticated] = useState(false); // 인증 상태 관리
  const [userRole, setUserRole] = useState(null); // 사용자 역할 (예: 'admin', 'member')

  const login = (role) => {
    setIsAuthenticated(true);
    setUserRole(role);
  };

  const logout = () => {
    setIsAuthenticated(false);
    setUserRole(null);
  };

  return (
    <AuthContext.Provider value={{ isAuthenticated, userRole, login, logout }}>
      {children}
    </AuthContext.Provider>
  );
};

export const useAuth = () => useContext(AuthContext);
```

---

### 3. **권한에 따른 접근 제한**
`ProtectedRoute`를 구현하여 사용자 인증 상태를 확인하고 페이지 접근을 제한합니다.

#### 예시: `ProtectedRoute` 컴포넌트
```javascript
import React from "react";
import { Navigate } from "react-router-dom";
import { useAuth } from "./AuthProvider";

const ProtectedRoute = ({ children, requiredRole }) => {
  const { isAuthenticated, userRole } = useAuth();

  if (!isAuthenticated) {
    return <Navigate to="/login" />; // 로그인 페이지로 이동
  }

  if (requiredRole && userRole !== requiredRole) {
    return <Navigate to="/unauthorized" />; // 권한 부족 페이지로 이동
  }

  return children;
};

export default ProtectedRoute;
```

---

### 4. **라우팅 설정**
React Router를 활용하여 각 페이지를 권한에 따라 표시합니다.

#### 예시: 라우팅 설정
```javascript
import React from "react";
import { BrowserRouter as Router, Route, Routes } from "react-router-dom";
import { AuthProvider } from "./AuthProvider";
import ProtectedRoute from "./ProtectedRoute";
import Home from "./Home";
import Dashboard from "./Dashboard";
import Login from "./Login";
import Unauthorized from "./Unauthorized";

const App = () => {
  return (
    <AuthProvider>
      <Router>
        <Routes>
          <Route path="/login" element={<Login />} />
          <Route path="/" element={<Home />} />
          <Route
            path="/dashboard"
            element={
              <ProtectedRoute requiredRole="admin">
                <Dashboard />
              </ProtectedRoute>
            }
          />
          <Route path="/unauthorized" element={<Unauthorized />} />
        </Routes>
      </Router>
    </AuthProvider>
  );
};

export default App;
```

---

### 5. **페이지 컴포넌트**
각 페이지 컴포넌트를 역할에 따라 작성합니다.

#### `Dashboard` 페이지
```javascript
import React from "react";

const Dashboard = () => {
  return <h1>관리자 대시보드</h1>;
};

export default Dashboard;
```

#### `Unauthorized` 페이지
```javascript
import React from "react";

const Unauthorized = () => {
  return <h1>권한이 부족합니다.</h1>;
};

export default Unauthorized;
```

---

### 6. **로그인 처리**
로그인 버튼 클릭 시 사용자의 권한과 인증 상태를 업데이트합니다.

#### `Login` 컴포넌트 예시:
```javascript
import React from "react";
import { useAuth } from "./AuthProvider";
import { useNavigate } from "react-router-dom";

const Login = () => {
  const { login } = useAuth();
  const navigate = useNavigate();

  const handleLogin = () => {
    login("admin"); // 사용자 역할 설정
    navigate("/dashboard"); // 로그인 후 대시보드로 이동
  };

  return (
    <div>
      <h1>로그인 페이지</h1>
      <button onClick={handleLogin}>관리자로 로그인</button>
    </div>
  );
};

export default Login;
```

---

### 권장 컴포넌트 구성:
1. **`AuthProvider`**: 인증 상태 및 권한 관리.
2. **`ProtectedRoute`**: 권한 확인 및 접근 제한 처리.
3. **라우트 설정**: 각 페이지를 권한에 따라 분기.
4. **페이지 컴포넌트**: 역할별로 구현된 Home, Dashboard, Login 등.

---

이 구조를 사용하면 효율적으로 사용자 권한을 관리하고, 권한 기반으로 페이지 접근을 제한할 수 있습니다. 추가로 궁금한 점이 있거나 세부 구현이 필요하면 말씀해주세요! 😊


======

권한없음 알림이나 페이지로 이동해야하는데 로그인 페이지만 보여주는 중


===========

03.21   

<br/><br/>

처음 들어오면 privateEnter에서 레벨 값 확인,   
레벨 0 or undefined 일 경우 로그인 and 회원가입 페이지
레벨 1이면 승인 대기 페이지
레벨 2이상이면 홈 화면 보여주기. 모든 페이지 이동 가능   
   
페이지 이동은 컴포넌트 x 루트로 링크 이동

---

## 완성된 코드

### PrivateEnterRoute.jsx
```
import React, { useState, useEffect } from "react";
import { Router, Routes, Route, Navigate } from "react-router-dom";
import App from "../App.jsx";
import Main from "../pages/Main.jsx";
import Login from "../pages/Login.jsx";
import Signup from "../pages/Signup.jsx";
import ApprovalPendingScreen from "./ApprovalPendingScreen.jsx";
import BoardList from "../pages/BoardList.jsx";
import ProtectedRoute from "../ProtectedRoute";
import { useAuth } from "../AuthProvider";

const PrivateEnterRoute = () => {
  const level = Number(sessionStorage.user_lvl) || 0;
  const [showSignup, setShowSignup] = useState(false);

  if (level < 1) {
    return showSignup ? (
      <>
        PrivateEnterRoute navigate to Signup
        <br />
        level : {level}
        <Navigate to="/signup" />
        <Signup setShowSignup={setShowSignup} />
      </>
    ) : (
      <>
        PrivateEnterRoute navigate to login
        <br />
        level : {level}
        <Navigate to="/login" />
        <Login onSignupClick={() => setShowSignup(true)} />
      </>
    );
  } else if (level === 1) {
    return <ApprovalPendingScreen />;
  }

  return (
    <>
      PrivateEnterRoute
      <br />
      level: {level}
      <App level={level} />
    </>
  );
};

export default PrivateEnterRoute;
```

사용자의 인증 상태에 따라 다른 컴포넌트를 렌더링합니다.

---

### 1. **`level`의 역할**
- `sessionStorage.user_lvl` 값을 가져와 숫자로 변환하고, 값이 없으면 기본값을 `0`으로 설정합니다.
- `level` 변수는 사용자의 권한 또는 인증 상태를 나타냅니다:
  - `level < 1`: 로그인 또는 회원가입 필요.
  - `level === 1`: 승인 대기 상태.
  - `level > 1`: 정상적으로 인증된 상태.

---

### 2. **`showSignup` 상태**
- `useState(false)`를 사용해 초기값은 `false`로 설정됩니다.
- 사용자가 로그인 화면에서 회원가입 버튼을 클릭하면 이 상태가 `true`로 변경되어 회원가입 화면으로 전환됩니다.

이 부분에서 애먹었는데   
회원가입 페이지에서 로그인 페이지나 메인 페이지로 이동하는 버튼을 추가하고 `<Navigate to="/login" />`이나 `<navigate=('/')>`라는 코드가 작동하지 않아서 privateEnterRoute에서 컴포넌트들을 로딩하지 않아서 그런가 싶었는데    
답은 `useState(true)`에 있었다.
해당 스테이트가 `true`를 반환하는 중이라 로그인 페이지로 이동해도 회원가입 페이지로 이동 중이었다.   
이전 버튼을 눌렀을 때 해당 스테이트 값을 `false`로 변경했다.

---

### 3. **조건별 렌더링 (if/else 구조)**
#### (a) **`level < 1`**
- 사용자가 인증되지 않은 경우, `showSignup` 상태에 따라 다음 중 하나를 렌더링합니다:
  - **회원가입 화면**:
    - `<Navigate to="/signup" />`: URL을 `/signup`으로 변경.
    - `<Signup />` 컴포넌트를 렌더링하며, `setShowSignup`을 통해 회원가입/로그인 화면 간 전환을 지원.
  - **로그인 화면**:
    - `<Navigate to="/login" />`: URL을 `/login`으로 변경.
    - `<Login />` 컴포넌트를 렌더링하며, 사용자가 회원가입 화면으로 전환할 수 있도록 `onSignupClick` 콜백 제공.

#### (b) **`level === 1`**
- 사용자가 승인 대기 중인 상태면, `<ApprovalPendingScreen />` 컴포넌트를 렌더링합니다.

#### (c) **`level > 1`**
- 사용자가 정상적으로 인증된 상태면, `<App />` 컴포넌트를 렌더링하며 `level` 값을 전달합니다.

---

### 4. **컴포넌트의 반환 구조**
컴포넌트의 최종 출력은 다음과 같이 동작합니다:
- 인증 상태(`level`)에 따라 적절한 화면(회원가입, 로그인, 승인 대기, 앱 화면)으로 사용자를 이동시킵니다.
- URL 변경을 위해 `react-router-dom`의 `<Navigate />`를 활용합니다.

---
